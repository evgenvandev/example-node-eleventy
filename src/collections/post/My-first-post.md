---
title: Начало работы с Eleventy за 11 минут
slug: my-first-post
date: 2024-12-24
authors:
  - evgeny
tags:
  - data
  - doc
image: /static/img/my-first-post/title-11ty-sample-project.jpg
isFeatured: false
description: Описание поста
comments: false
color-title: red
---

[Оригинал статьи](https://dev.to/loige/getting-started-with-eleventy-in-11-minutes-496j?ysclid=m4cgbwznqv999658354 "Начало работы с Eleventy за 11 минут")   
В этой статье мы рассмотрим Eleventy - быстрый и простой генератор статических сайтов, написанный на Node.js.

Мы сделаем это очень практичным способом, постепенно создавая простой пример веб-сайта с нуля.

В ходе этого упражнения мы изучим некоторые базовые концепции, которые необходимо освоить при работе с Eleventy, такие как шаблоны, макеты, файлы дынных и даже то, как использовать данные из внешних источников, таких как сторонние REST API.

Весь код из этой статьи доступен на GitHub по адресу [lmammino/11ty-sample-project](https://github.com/lmammino/11ty-sample-project "Примеры кода из статьи").

## Запуск проекта

Давайте сразу приступим к созданию нового проекта под названием `11ty-sample-project`: 

```bash
mkdir 11ty-sample-project
cd 11ty-sample-project
npm init -y
```

## Установка Eleventy и создание нашего первого сайта

Eleventy можно установить с помощью `npm`. Вы можете установить его глобально в своей системе, но я лично предпочитаю устанавливать его как зависимость разработки для определённого проекта. Таким образом, вы можете иметь разные проекты, использующие разные версии Eleventy, если это необходимо.

```bash
npm install --save-dev @11ty/eleventy@2.0.1
```

Здесь я устанавливаю версию Eleventy `2.0.1`, так как это последняя версия, которая работает на `Node.js v16`. 
Версия Eleventy `3.0.0`, которая вышла в 2024 году, работает только на `Node.js v18` и выше.

Теперь давайте создадим индексный файл `index.md` для нашего проекта Eleventy:

```bash
echo "# My sample Eleventy website" > index.md
```

На этом этапе мы готовы запустить Eleventy:

```bash
node_modules/.bin/eleventy --watch --serve
```

Конечно, для простоты мы можем поместить этот скрипт в наш `package.json`:

```json
// ...
"scripts": {
  "start": "eleventy --watch --serve",
},
// ...
```

Теперь нам будет проще запустить Eleventy, просто выполнив: 

```bash
npm start
```

Теперь мы можем видеть наш сайт по адресу [localhost:8080](http://localhost:8080/ "Первый запуск сайта")
![Первый скриншот сайта](/static/img/my-first-post/first_screenshot_of_site.png "Первый запуск сайта")

## Создаём пользовательский файл конфигурации

Eleventy следует некоторым соглашениям по умолчанию, но он также достаточно гибок и позволяет изменять эти настройки по умолчанию. 

Это удобно, если по какой-либо причине вы предпочитаете изменить структуру папок по умолчанию или поддерживаемые языки шаблонов и многое другое. 

Чтобы предоставить Eleventy нашу пользовательскую конфигурацию, нам необходимо создать файл с именем `.eleventy.js` в корневой папке нашего проекта, со следующим содержимым: 

```js
module.exports = function(config) {
  return {
    dir: {
      input: './src',
      output: './build',
    },
  };
};
```
С этой конкретной конфигурацией мы переопределяем папки ввода и вывода для проекта. Все наши исходные файлы будут внутри `src`, а сгенерированные файлы будут в `build`.

Теперь давайте фактически создадим папку `src` и переместим файл `index.md` в папку `src`. Мы также можем удалить старую папку сборки сайта (`_site`): 

```bash
mkdir src
mv index.md src
rm -rf _site
```

Наконец, обязательно перезапустим Eleventy. Наш сайт не изменился, но теперь все сгенерированные файлы будут храниться в `build`.

Вы могли заметить, что в нашем файле конфигурации определение функции получает аргумент с именем `config`. Это то, что позволяет выполнять более расширенную настройку.

## Шаблоны Nunjucks с вводной частью

До сих пор мы использовали только файлы _markdown_ для определения содержимого нашего статического сайта. Давайте теперь создадим шаблон [Nunjucks](https://mozilla.github.io/nunjucks/), с именем `page.njk` и поместим его в папку `src`. Содержимое файла `page.njk` следующее: 

```html
<!DOCTYPE html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>A new website</title>
</head>
<body>A sample page here</body>
</html>
```

После сохранения этого нового файла сборка сгенерирует новую страницу, которую мы сможем визуализировать по адресу [localhost:8080/page](http://localhost:8080/page "Шаблон страницы поста").

![Шаблон страницы поста](/static/img/my-first-post/template-page-1.png "Шаблон страницы поста")

Достаточно интересно, что теперь, если мы что-либо изменим в исходном шаблоне, браузер автоматически обновится, показывая нам результат последних изменений. 

Это потому, что как только у нас будет полная структура HTML, Eleventy внедрит на страницу скрипт [BrowserSync](https://browsersync.io/), который будет автоматически перезагружать страницу при каждом изменении. Обратите внимание, что этот код внедряется в страницы HTML только во время выполнения при получении страниц через веб-сервер разработки, на самом деле он не присутствует в сгенерированном HTML. По этой причине вам не нужно делать ничего особенного, чтобы сгенерировать сборку, готовую к развёртыванию на вашем производственном сервере. В любом случае, если вы хотите только сгенерировать сборку, не запуская веб-сервер разработки, вы можете сделать это, запустив `eleventy build`.

Но давайте теперь поговорим немного подробнее о шаблонах. 

В Eleventy markdown (`.md`), Nunjucks (`.njk`) и многие другие типы файлов ([см. полный список](https://www.11ty.dev/docs/languages/)) называются **шаблонами**. Эти файлы можно использовать в качестве скелета для генерации страниц. Eleventy автоматически выполнит их поиск в нашей исходной папке и по умолчанию сгенерирует страницу для каждого из них. Позже мы увидим, как можно использовать один шаблон для генерации нескольких страниц.

Шаблоны могут иметь в верхней части **вводную часть (frontmatter)**, которая может использоваться для определения дополнительных метаданных.

Вводная часть должна быть указана в верхней части файла и отделена `---`, как в следующем примере: 

```md
---
name: someone
age: 17
---
Rest of the file
```

Внутри вводной части метаданные указываются с помощью YAML, и вы даже можете иметь вложенные свойства, если это имеет смысл для вашего конкретного варианта использования.

Я думаю, что в нашем проекте имеет смысл использовать _frontmatter_ для добавления атрибута `title` в наш новый шаблон:

```html
---
title: A NOT SO NEW website
---
<!DOCTYPE html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{% raw %}{{ title }}{% endraw %}</title>
</head>
<body>A sample page here</body>
</html>
```

Обратите внимание, что данные в водной части можно сразу же использовать в нашем шаблоне, используя синтаксис интерполяции выбранного языка шаблонов (`{% raw %}{{ variableName }}{% endraw %}` в случае Nunjucks).

## Макеты

Что, если мы хотим, чтобы все сгенерированные страницы (или только некоторые из них) имели одинаковую структуру HTML? Кроме того, если мы хотим использовать markdown, в идеале мы хотели бы, чтобы сгенерированный HTML был обёрнут в правильно построенный макет HTML, который включает `head` и `body` раздел.

С помощью Eleventy мы можем сделать это с помощью **макетов**. 

Макеты могут храниться внутри `_includes` каталога в исходной папке `src`. Это специальная папка. Фактически, Eleventy не будет генерировать страницы для markdown, Nunjucks или других файлов шаблонов, доступных внутри этой папки. Eleventy также позаботится о том, чтобы все файлы, размещённые здесь, были легко доступны для языка шаблонов по нашему выбору. 

Давайте создадим наш первый макет в `src/_includes/base.njk`: 

```html
---
title: My default title
---
<!DOCTYPE html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{% raw %}{{ title }}{% endraw %}</title>
</head>
<body>
  <main>
    {% raw %}{{ content | safe }}{% endraw %}
  </main>
</body>
</html>
```

Обратите внимание, что специальная переменная `content` - это место, где будет размещён основной контент (из шаблона). Мы используем фильтр `safe`, потому что хотим, чтобы HTML из шаблона применялся дословно (без экранированного текста). 

Без `safe` HTML, поступающий из шаблона, содержащий, `<h1>Hello from Eleventy</h1>` будет отображаться следующим образом: 

```html
<!--  ... -->
<body>
  <main>
    &lt;h1&gt;Hello from Eleventy&lt;/h1&gt;
  </main>
</body>
```

Что, конечно, не то, чего мы хотим...

Теперь мы можем вернуться и отредактировать файл `index.md`, используя наш базовый шаблон: 

```text-Markdown
---
layout: base
---

# Hello from Eleventy

This is a simple Eleventy demo
```

Теперь мы можем попробовать перезагрузить нашу индексную страницу и проверить исходный код страницы в браузере!

![Используем макет base.njk](/static/img/my-first-post/template-using-layout-1.jpg "Используем макет base.njk")

## Копирование статических файлов

Что, если мы хотим добавить немного стиля к нашим сгенерированным страницам? Как нам добавить CSS? Конечно, мы могли бы легко добавить встроенный CSS в наши шаблоны и макеты, но что, если мы хотим включить внешний файл CSS?

Давайте создадим файл `src/_includes/style.css` со следующим содержимым:

```css
html, body {
  background-color: #eee;
  margin: 0;
}

main {
  box-sizing: border-box;
  max-width: 1024px;
  min-height: 100vh;
  padding: 2em;
  margin: 0 auto;
  background: white;
}
```

Как же нам убедиться, что этот CSS-файл скопирован в папку сборки?

Давайте отредактируем конфигурацию `.eleventy.js`: 

```js
module.exports = function(config) {
  config.addPassthroughCopy({'./src/_includes/style.css': style.css});
}
```

Вызов функции `addPassthroughCopy` по сути сообщает Eleventy, что для каждой сборки заданный исходный файл необходимо будет скопировать (как есть) в заданное место назначения в папке сборки. 

Проверьте папку сборки, и вы увидите там файл `style.css`! Если его там нет, попробуйте перезапустить сборку Eleventy. 

Теперь мы можем обновить наш макет по умолчанию `src/_includes/base.njk`, чтобы ссылаться на эту таблицу стилей, добавив следующий код в блок `head`: 

```html
<link rel="stylesheet" href="/style.css"/>
```

По сути, это сообщит браузеру о необходимости загрузки стиля CSS из нашего файла `style.css` при загрузке страницы. 

![Добавление файла style.css](/static/img/my-first-post/add_style_css_to_site.png "Добавление файла style.css в тег <link />")

Эту же технику можно использовать для копирования клиентских файлов JavaScript, изображений, видео или других статических ресурсов в папку сборки.

## Глобальные файлы данных

При создании статических сайтов у нас обычно есть некоторые "глобальные" данные, на которые мы хотим ссылаться в наших шаблонах и макетах.